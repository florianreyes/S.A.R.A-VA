import speech_recognition as sr
import playsound
from gtts import gTTS
import yfinance as yf
import matplotlib.pyplot as plt
from datetime import datetime
import subprocess
import os


stocks = {'walmart': 'WMT', 'amazon': 'AMZN', 'exxon mobil': 'XOM', 'apple': 'AAPL', 'cvs health': 'CVS', 'berkshire hathaway': 'BRKA', 'unitedhealth group': 'UNH', 'mckesson': 'MCK', 'at&t': 'T', 'amerisourcebergen': 'ABC', 'alphabet': 'GOOGL', 'ford motor': 'F', 'cigna': 'CI', 'costco wholesale': 'COST', 'chevron': 'CVX', 'cardinal health': 'CAH', 'jpmorgan chase': 'JPM', 'general motors': 'GM', 'walgreens boots alliance': 'WBA', 'verizon communications': 'VZ', 'microsoft': 'MSFT', 'marathon petroleum': 'MPC', 'kroger': 'KR', 'fannie mae': 'FNMA', 'bank of america': 'BAC', 'home depot': 'HD', 'phillips 66': 'PSX', 'comcast': 'CMCSA', 'anthem': 'ANTM', 'wells fargo': 'WFC', 'citigroup': 'C', 'valero energy': 'VLO', 'general electric': 'GE', 'dell technologies': 'DELL', 'johnson & johnson': 'JNJ', 'state farm insurance': '', 'target': 'TGT', 'ibm': 'IBM', 'raytheon technologies': 'RTX', 'boeing': 'BA', 'freddie mac': 'FMCC', 'centene': 'CNC', 'ups': 'UPS', 'lowe&#8217;s': 'LOW', 'intel': 'INTC', 'facebook': 'FB', 'fedex': 'FDX', 'metlife': 'MET', 'walt disney': 'DIS', 'procter & gamble': 'PG', 'pepsico': 'PEP', 'humana': 'HUM', 'prudential financial (u.s.)': 'PRU', 'archer daniels midland': 'ADM', 'albertsons': 'ACI', 'sysco': 'SYY', 'lockheed martin': 'LMT', 'hp': 'HPQ', 'energy transfer': 'ET', 'goldman sachs group': 'GS', 'morgan stanley': 'MS', 'caterpillar': 'CAT', 'cisco systems': 'CSCO', 'pfizer': 'PFE', 'hca healthcare': 'HCA', 'american international group': 'AIG', 'american express': 'AXP', 'delta air lines': 'DAL', 'merck': 'MRK', 'american airlines group': 'AAL', 'charter communications': 'CHTR', 'allstate': 'ALL', 'new york life insurance': '', 'nationwide': '', 'best buy': 'BBY', 'united airlines holdings': 'UAL', 'liberty mutual insurance group': '', 'dow': 'DOW', 'tyson foods': 'TSN', 'tjx': 'TJX', 'tiaa': '', 'oracle': 'ORCL', 'general dynamics': 'GD', 'deere': 'DE', 'nike': 'NKE', 'progressive': 'PGR', 'publix super markets': '', 'coca-cola': 'KO', 'massachusetts mutual life': '', 'tech data': 'TECD', 'world fuel services': 'INT', 'honeywell international': 'HON', 'conocophillips': 'COP', 'usaa': '', 'exelon': 'EXC', 'northrop grumman': 'NOC', 'capital one financial': 'COF', 'plains gp holdings': 'PAGP', 'abbvie': 'ABBV', 'stonex group': 'SNEX', 'enterprise products partners': 'EPD', 'northwestern mutual': '', '3m': 'MMM', 'abbott laboratories': 'ABT', 'chs': '', 'travelers cos.': 'TRV', 'philip morris international': 'PM', 'raytheon': '', 'hewlett packard enterprise': 'HPE', 'arrow electronics': 'ARW', 'viacomcbs': 'VIAC', 'dollar general': 'DG', 'u.s. bancorp': 'USB', 'starbucks': 'SBUX', 'bristol-myers squibb': 'BMY', 'us foods holding': 'USFD', 'mondelez international': 'MDLZ', 'paccar': 'PCAR', 'thermo fisher scientific': 'TMO', 'macy&#8217;s': 'M', 'jabil': 'JBL', 'kraft heinz': 'KHC', 'duke energy': 'DUK', 'tesla': 'TSLA', 'pbf energy': 'PBF', 'qualcomm': 'QCOM', 'ngl energy partners': 'NGL', 'cbre group': 'CBRE', 'baker hughes': 'BKR', 'synnex': 'SNX', 'dollar tree': 'DLTR', 'cummins': 'CMI', 'united natural foods': 'UNFI', 'micron technology': 'MU', 'amgen': 'AMGN', 'penske automotive group': 'PAG', 'visa': 'V', 'broadcom': 'AVGO', 'nucor': 'NUE', 'gilead sciences': 'GILD', 'southwest airlines': 'LUV', 'halliburton': 'HAL', 'lumen technologies': 'LUMN', 'international paper': 'IP', 'eli lilly': 'LLY', 'aflac': 'AFL', 'lennar': 'LEN', 'occidental petroleum': 'OXY', 'union pacific': 'UNP', 'rite aid': 'RAD', 'pnc financial services group': 'PNC', 'dupont': 'DD', 'southern company': 'SO', 'autonation': 'AN', 'dxc technology': 'DXC', 'mcdonald&#8217;s': 'MCD', 'marriott international': 'MAR', 'manpowergroup': 'MAN', 'bank of new york mellon': 'BK', 'hartford financial services group': 'HIG', 'danaher': 'DHR', 'whirlpool': 'WHR', 'aecom': 'ACM', 'netflix': 'NFLX', 'kohl&#8217;s': 'KSS', 'lear': 'LEA', 'altria group': 'MO', 'performance food group': 'PFGC', 'avnet': 'AVT', 'synchrony financial': 'SYF', 'genuine parts': 'GPC', 'nextera energy': 'NEE', 'carmax': 'KMX', 'tenet healthcare': 'THC', 'kimberly-clark': 'KMB', 'emerson electric': 'EMR', 'westrock': 'WRK', 'cdw': 'CDW', 'jones lang lasalle (jll)': 'JLL', 'sherwin-williams': 'SHW', 'fluor': 'FLR', 'paypal holdings': 'PYPL', 'd.r. horton': 'DHI', 'hollyfrontier': 'HFC', 'tenneco': 'TEN', 'eog resources': 'EOG', 'bd': 'BDX', 'lincoln national': 'LNC', 'pg&e': 'PCG', 'salesforce': 'CRM', 'mastercard': 'MA', 'general mills': 'GIS', 'molina healthcare': 'MOH', 'cognizant technology solutions': 'CTSH', 'marsh & mclennan': 'MMC', 'xpo logistics': 'XPO', 'dominion energy': 'D', 'western digital': 'WDC', 'gap': 'GPS', 'aramark': 'ARMK', 'principal financial': 'PFG', 'ross stores': 'ROST', 'colgate-palmolive': 'CL', 'american electric power': 'AEP', 'nordstrom': 'JWN', 'jacobs engineering group': 'J', 'waste management': 'WM', 'c.h. robinson worldwide': 'CHRW', 'ppg industries': 'PPG', 'booking holdings': 'BKNG', 'omnicom group': 'OMC', 'loews': 'L', 'ecolab': 'ECL', 'stryker': 'SYK', 'est√©e lauder': 'EL', 'goodyear tire & rubber': 'GT', 'truist financial': 'TFC', 'applied materials': 'AMAT', 'blackrock': 'BLK', 'stanley black & decker': 'SWK', 'freeport-mcmoran': 'FCX', 'texas instruments': 'TXN', 'biogen': 'BIIB', 'parker-hannifin': 'PH', 'reinsurance group of america': 'RGA', 'howmet aerospace': 'HWM', 'automatic data processing': 'ADP', 'uber technologies': 'UBER', 'illinois tool works': 'ITW', 'davita': 'DVA', 'discover financial services': 'DFS', 'land o&#8217;lakes': '', 'vf': 'VFC', 'corteva': 'CTVA', 'las vegas sands': 'LVS', 'textron': 'TXT', 'kellogg': 'K', 'guardian life ins. co. of america': '', 'qurate retail': 'QRTEA', 'core-mark holding': 'CORE', 'community health systems': 'CYH', 'kinder morgan': 'KMI', "bj's wholesale club": 'BJ', 'state street': 'STT', 'ameriprise financial': 'AMP', 'global partners': 'GLP', 'united states steel': 'X', 'l brands': 'LB', 'mgm resorts international': 'MGM', 'l3harris technologies': 'LHX', 'dish network': 'DISH', 'lithia motors': 'LAD', 'dte energy': 'DTE', 'american family insurance group': '', 'farmers insurance exchange': '', 'consolidated edison': 'ED', 'lkq': 'LKQ', 'sempra energy': 'SRE', 'edison international': 'EIX', 'centerpoint energy': 'CNP', 'quanta services': 'PWR', 'murphy usa': 'MUSA', 'expedia group': 'EXPE', 'group 1 automotive': 'GPI', 'bed bath & beyond': 'BBBY', 'unum group': 'UNM', 'csx': 'CSX', 'autozone': 'AZO', 'pacific life': '', 'vistra energy': 'VST', 'charles schwab': 'SCHW', 'crown holdings': 'CCK', 'ally financial': 'ALLY', 'laboratory corp. of america (labcorp)': 'LH', 'live nation entertainment': 'LYV', 'xcel energy': 'XEL', 'corning': 'GLW', 'w.w. grainger': 'GWW', 'ball': 'BLL', 'fox': 'FOXA', 'universal health services': 'UHS', 'baxter international': 'BAX', 'norfolk southern': 'NSC', 'navistar international': 'NAV', 'adobe': 'ADBE', 'j.c. penney': 'JCP', 'discovery': 'DISCA', 'keurig dr pepper': 'KDP', 'leidos holdings': 'LDOS', 'iqvia holdings': 'IQV', 'reliance steel & aluminum': 'RS', 'nvidia': 'NVDA', 'entergy': 'ETR', 'firstenergy': 'FE', 'ebay': 'EBAY', 'boston scientific': 'BSX', 'odp': 'ODP', 'molson coors beverage': 'TAP', 'steel dynamics': 'STLD', 'mutual of omaha insurance': '', 'sonic automotive': 'SAH', 'alcoa': 'AA', 'fidelity national information services': 'FIS', 'henry schein': 'HSIC', 'republic services': 'RSG', 'liberty media': 'LSXMA', 'peter kiewit sons&#8217;': '', 'interpublic group': 'IPG', 'pultegroup': 'PHM', 'aes': 'AES', 'fiserv': 'FISV', 'borgwarner': 'BWA', 'oneok': 'OKE', 'o&#8217;reilly automotive': 'ORLY', 'assurant': 'AIZ', 'newell brands': 'NWL', 'public service enterprise group': 'PEG', 'news corp.': 'NWSA', 'calpine': '', 'auto-owners insurance': '', 'mohawk industries': 'MHK', 'pvh': 'PVH', 'campbell soup': 'CPB', 'nrg energy': 'NRG', 'fifth third bancorp': 'FITB', 'hertz global holdings': 'HTZ', 'altice usa': 'ATUS', 'newmont': 'NEM', 'cheniere energy': 'LNG', 'advance auto parts': 'AAP', 'lam research': 'LRCX', 'owens & minor': 'OMI', 'equitable holdings': 'EQH', 'conagra brands': 'CAG', 'markel': 'MKL', 'jones financial (edward jones)': '', 'hormel foods': 'HRL', 'hilton worldwide holdings': 'HLT', 'univar solutions': 'UNVR', 'united rentals': 'URI', 'pioneer natural resources': 'PXD', 'delek us holdings': 'DK', 'eastman chemical': 'EMN', 'emcor group': 'EME', 'avis budget group': 'CAR', 'j.b. hunt transport services': 'JBHT', 'xerox holdings': 'XRX', 'wayfair': 'W', 'kkr': 'KKR', 'agco': 'AGCO', 'alleghany': 'Y', 'icahn enterprises': 'IEP', 'voya financial': 'VOYA', 'ryder system': 'R', 'air products & chemicals': 'APD', 'mosaic': 'MOS', 'huntington ingalls industries': 'HII', 'berry global group': 'BERY', 'anixter international': '', 'alaska air group': 'ALK', 'yum china holdings': 'YUMC', 'dick&#8217;s sporting goods': 'DKS', 'caesars holdings': '', 'genworth financial': 'GNW', 'targa resources': 'TRGP', 'coty': 'COTY', 'dana': 'DAN', 'thrivent financial for lutherans': '', 'autoliv': 'ALV', 'spartannash': 'SPTN', 'eversource energy': 'ES', 'darden restaurants': 'DRI', 'chesapeake energy': 'CHKAQ', 'nov': 'NOV', 'fidelity national financial': 'FNF', 'erie insurance group': '', 'oshkosh': 'OSK', 'casey&#8217;s general stores': 'CASY', 'wesco international': 'WCC', 'tractor supply': 'TSCO', 'commscope holding': 'COMM', 'huntsman': 'HUN', 'american financial group': 'AFG', 'masco': 'MAS', 'sanmina': 'SANM', 'amphenol': 'APH', 'williams': 'WMB', 'westinghouse air brake': 'WAB', 'expeditors intl. of washington': 'EXPD', 'andersons': 'ANDE', 'westlake chemical': 'WLK', 'constellation brands': 'STZ', 'frontier communications': 'FTRCQ', 'jetblue airways': 'JBLU', 'citizens financial group': 'CFG', 'raymond james financial': 'RJF', 'foot locker': 'FL', 'hershey': 'HSY', 'zimmer biomet holdings': 'ZBH', 'cincinnati financial': 'CINF', 'western & southern financial group': '', 'w.r. berkley': 'WRB', 'motorola solutions': 'MSI', 'thor industries': 'THO', 'regeneron pharmaceuticals': 'REGN', 'spirit aerosystems holdings': 'SPR', 'j.m. smucker': 'SJM', 'ppl': 'PPL', 'insight enterprises': 'NSIT', 'quest diagnostics': 'DGX', 'keycorp': 'KEY', 'veritiv': 'VRTV', 'dcp midstream': 'DCP', 'american tower': 'AMT', 'graybar electric': '', 'wec energy group': 'WEC', 'nvr': 'NVR', 'ulta beauty': 'ULTA', 'devon energy': 'DVN', 'blackstone group': 'BX', 'dean foods': 'DFODQ', 'fortive': 'FTV', 'ugi': 'UGI', 'burlington stores': 'BURL', 'builders firstsource': 'BLDR', 'toll brothers': 'TOL', 'old republic international': 'ORI', 'asbury automotive group': 'ABG', 'arthur j. gallagher': 'AJG', 'mastec': 'MTZ', 'owens corning': 'OC', 'magellan health': 'MGLN', 'dover': 'DOV', 'beacon roofing supply': 'BECN', 'avery dennison': 'AVY', 'hanesbrands': 'HBI', 'packaging corp. of america': 'PKG', 'm&t bank': 'MTB', 'ncr': 'NCR', 'northern trust': 'NTRS', 'cintas': 'CTAS', 'polaris': 'PII', 'cms energy': 'CMS', 'seaboard': 'SEB', 'intuit': 'INTU', 'regions financial': 'RF', 'fm global': '', 'advanced micro devices (amd)': 'AMD', 'ovintiv': 'OVV', 'booz allen hamilton holding': 'BAH', 's&p global': 'SPGI', 'rockwell automation': 'ROK', 'o-i glass': 'OI', 'wynn resorts': 'WYNN', 'securian financial group': '', 'alliance data systems': 'ADS', 'weyerhaeuser': 'WY', 'brighthouse financial': 'BHF', 'intercontinental exchange': 'ICE', 'american axle & manufacturing': 'AXL', 'hess': 'HES', 'abm industries': 'ABM', 'activision blizzard': 'ATVI', 'gamestop': 'GME', 'apa': 'APA', 'science applications international': 'SAIC', 'ak steel holding': '', 'dillard&#8217;s': 'DDS', 'ralph lauren': 'RL', 'celanese': 'CE', 'r.r. donnelley & sons': 'RRD', 'zoetis': 'ZTS', 'ascena retail group': 'ASNA', 'clorox': 'CLX', 'ingredion': 'INGR', 'first american financial': 'FAF', 'graphic packaging holding': 'GPK', 'netapp': 'NTAP', 'hd supply holdings': '', 'travelcenters of america': 'TA', 'olin': 'OLN', 'robert half international': 'RHI', 'enlink midstream': 'ENLC', 'avantor': 'AVTR', 'tapestry': 'TPR', 'td ameritrade holding': '', 'analog devices': 'ADI', 'ameren': 'AEE', 'williams-sonoma': 'WSM', 'realogy holdings': 'RLGY', 'commercial metals': 'CMC', 'rush enterprises': 'RUSHB', 'franklin resources': 'BEN', 'fortune brands home & security': 'FBHS', 'levi strauss': 'LEVI', 'crown castle international': 'CCI', 'simon property group': 'SPG', 'cerner': 'CERN', 'post holdings': 'POST', 'huntington bancshares': 'HBAN', 'kbr': 'KBR', 'sprouts farmers market': 'SFM', 'lpl financial holdings': 'LPLA', 't. rowe price': 'TROW', 'yum brands': 'YUM', 'chipotle mexican grill': 'CMG', 'patterson': 'PDCO', 'rpm international': 'RPM',
          'equinix': 'EQIX', 'navient': 'NAVI', 'alibaba': 'BABA', 'chemours': 'CC', 'on semiconductor': 'ON', 'transdigm group': 'TDG', 'host hotels & resorts': 'HST', 'select medical holdings': 'SEM', 'par pacific holdings': 'PARR', 'sonoco products': 'SON', 'roper technologies': 'ROP', 'harley-davidson': 'HOG', 'jefferies financial group': 'JEF', 'kelly services': 'KELYA', 'microchip technology': 'MCHP', 'mccormick': 'MKC', 'mdu resources group': 'MDU', 'fastenal': 'FAST', 'big lots': 'BIG', 'penn national gaming': 'PENN', 'western union': 'WU', 'under armour': 'UAA', 'xylem': 'XYL', 'skechers u.s.a.': 'SKX', 'domtar': 'UFS', 'nisource': 'NI', 'marathon oil': 'MRO', 'national general holdings': '', 'telephone & data systems': 'TDS', 'agilent technologies': 'A', 'ametek': 'AME', 'evergy': 'EVRG', 'international flavors & fragrances': 'IFF', 'adt': 'ADT', 'welltower': 'WELL', 'windstream holdings': 'WINMQ', 'michaels': 'MIK', 'kemper': 'KMPR', 'hyatt hotels': 'H', 'alexion pharmaceuticals': 'ALXN', 'resideo technologies': 'REZI', 'caci international': 'CACI', 'electronic arts': 'EA', 'vulcan materials': 'VMC', 'treehouse foods': 'THS', 'global payments': 'GPN', 'hanover insurance group': 'THG', 'camping world holdings': 'CWH', 'cornerstone building brands': 'CNR', 'yellow': 'YELL', 'cme group': 'CME', 'chewy': 'CHWY', 'knight-swift transportation holdings': 'KNX', 'moody&#8217;s': 'MCO', 'coca-cola consolidated': 'COKE', 'carlisle': 'CSL', 'sealed air': 'SEE', 'a-mark precious metals': 'AMRK', 'watsco': 'WSO', 'taylor morrison home': 'TMHC', 'iac/interactivecorp': 'IAC', 'leggett & platt': 'LEG', 'onemain holdings': 'OMF', 'schneider national': 'SNDR', 'martin marietta materials': 'MLM', 'nortonlifelock': 'NLOK', 'hasbro': 'HAS', 'square': 'SQ', 'terex': 'TEX', 'syneos health': 'SYNH', 'fmc': 'FMC', 'boise cascade': 'BCC', 'ss&c technologies holdings': 'SSNC', 'continental resources': 'CLR', 'peabody energy': 'BTU', 'encompass health': 'EHC', 'greif': 'GEF', 'concho resources': '', 'hubbell': 'HUBB', 'cf industries holdings': 'CF', 'kla': 'KLAC', 'genesis healthcare': 'GEN', 'brunswick': 'BC', 'kb home': 'KBH', 'globe life': 'GL', 'mattel': 'MAT', 'ryerson holding': 'RYI', 'silgan holdings': 'SLGN', 'zebra technologies': 'ZBRA', 'intuitive surgical': 'ISRG', 'warner music group': 'WMG', 'conduent': 'CNDT', 'tutor perini': 'TPC', 'juniper networks': 'JNPR', 'noble energy': '', 'vertiv holdings': 'VRT', 'tiffany': '', 'eqt': 'EQT', 'ufp industries': 'UFPI', 'diebold nixdorf': 'DBD', 'antero resources': 'AR', 'meritor': 'MTOR', 'broadridge financial solutions': 'BR', 'church & dwight': 'CHD', 'marriott vacations worldwide': 'VAC', 'edwards lifesciences': 'EW', 'colfax': 'CFX', 'insperity': 'NSP', 'american eagle outfitters': 'AEO', 'keysight technologies': 'KEYS', 'jeld-wen holding': 'JELD', 'iron mountain': 'IRM', 'nasdaq': 'NDAQ', 'gartner': 'IT', 'sinclair broadcast group': 'SBGI', 'ingles markets': 'IMKTA', 'monster beverage': 'MNST', 'murphy oil': 'MUR', 'vertex pharmaceuticals': 'VRTX', 'first republic bank': 'FRC', 'bloomin&#8217; brands': 'BLMN', 'spectrum brands holdings': 'SPB', 'quad/graphics': 'QUAD', 'flowers foods': 'FLO', 'cuna mutual group': '', 'allegheny technologies': 'ATI', 'old dominion freight line': 'ODFL', 'landstar system': 'LSTR', 'american national group': 'ANAT', 'snap-on': 'SNA', 'brookdale senior living': 'BKD', 'amkor technology': 'AMKR', 'wyndham destinations': 'WYND', 'ppd': 'PPD', 'dentsply sirona': 'XRAY', 'cno financial group': 'CNO', 'urban outfitters': 'URBN', 'sabre': 'SABR', 'mercury general': 'MCY', 'diamondback energy': 'FANG', 'parsons': 'PSN', "aaron's": 'AAN', 'flowserve': 'FLS', 'carvana': 'CVNA', 'asgn': 'ASGN', 'sally beauty holdings': 'SBH', 'scansource': 'SCSC', 'ventas': 'VTR', 'country financial': '', 'trinet group': 'TNET', 'spirit airlines': 'SAVE', 'comerica': 'CMA', 'lennox international': 'LII', 'timken': 'TKR', 'paychex': 'PAYX', 'amerco': 'UHAL', 'worthington industries': 'WOR', 'lamb weston holdings': 'LW', 'laureate education': 'LAUR', 'penn mutual life insurance': '', 'iheartmedia': 'IHRT', "brink's": 'BCO', 'sentry insurance group': '', 'acuity brands': 'AYI', 'hub group': 'HUBG', 'meritage homes': 'MTH', 'mrc global': 'MRC', 'alliant energy': 'LNT', 'workday': 'WDAY', 'bmc stock holdings': 'BMCH', 'abercrombie & fitch': 'ANF', "domino's pizza": 'DPZ', 'lyft': 'LYFT', 'meredith': 'MDP', 'american water works': 'AWK', 'albemarle': 'ALB', 'ciena': 'CIEN', 'barnes & noble': '', 'weis markets': 'WMK', 'illumina': 'ILMN', 'svb financial group': 'SIVB', "carter's": 'CRI', 'stifel financial': 'SF', 'mednax': 'MD', 'equifax': 'EFX', 'kar auction services': 'KAR', 'ashland global holdings': 'ASH', 'medical mutual of ohio': '', 'sprague resources': 'SRLP', 'super micro computer': 'SMCI', 'designer brands': 'DBI', 'pitney bowes': 'PBI', 'applied industrial technologies': 'AIT', 'pinnacle west capital': 'PNW', 'american equity investment life holding': 'AEL', 'servicenow': 'NOW', 'twitter': 'TWTR', 'calumet specialty products partners': 'CLMT', 'steelcase': 'SCS', 'sanderson farms': 'SAFM', 'wabco holdings': '', 'clean harbors': 'CLH', 'puget energy': '', 'scientific games': 'SGMS', 'granite construction': 'GVA', 'carlyle group': 'CG', 'skyworks solutions': 'SWKS', 'aleris': '', 'triple-s management': 'GTS', 'hexion': '', 'hologic': 'HOLX', 'triumph group': 'TGI', 'darling ingredients': 'DAR', 'msc industrial direct': 'MSM', 'red hat': '', 'synopsys': 'SNPS', 'polyone': 'POL', 'dycom industries': 'DY', 'cabot': 'CBT', 'prologis': 'PLD', 'boyd gaming': 'BYD', 'lsc communications': 'LKSDQ', 'brown-forman': 'BFB', 'stericycle': 'SRCL', 'cit group': 'CIT', 'mdc holdings': 'MDC', 'hyster-yale materials handling': 'HY', 'crane': 'CR', 'cinemark holdings': 'CNK', 'autodesk': 'ADSK', 'trimble': 'TRMB', 'garrett motion': 'GTX', 'zions bancorp.': 'ZION', 'regal beloit': 'RBC', 'service corp. international': 'SCI', 'varian medical systems': 'VAR', 'pricesmart': 'PSMT', 'brinker international': 'EAT', 'digital realty trust': 'DLR', 'pool': 'POOL', 'crestwood equity partners': 'CEQP', 'infor': '', 'plexus': 'PLXS', 'teledyne technologies': 'TDY', 'g-iii apparel group': 'GIII', 'scotts miracle-gro': 'SMG', 'apollo global management': 'APO', 'e*trade financial': '', 'toro': 'TTC', 'southwest gas holdings': 'SWX', 'gms': 'GMS', 'cooper-standard holdings': 'CPS', 'acadia healthcare': 'ACHC', 'tetra tech': 'TTEK', 'primoris services': 'PRIM', 'tempur sealy international': 'TPX', 'h&r block': 'HRB', 'qorvo': 'QRVO', 'tri pointe group': 'TPH', 'cracker barrel old country store': 'CBRL', 'elanco animal health': 'ELAN', 'pra health sciences': 'PRAH', 'first solar': 'FSLR', 'amc networks': 'AMCX', 'xilinx': 'XLNX', 'green plains': 'GPRE', 'columbia sportswear': 'COLM', 'nexstar media group': 'NXST', 'southwestern energy': 'SWN', 'greenbrier': 'GBX', 'presidio': '', 'citrix systems': 'CTXS', 'mettler-toledo international': 'MTD', 'trinity industries': 'TRN', 'mutual of america life insurance': '', 'lincoln electric holdings': 'LECO', 'tailored brands': 'TLRD', 'a.o. smith': 'AOS', 'arcbest': 'ARCB', 'godaddy': 'GDDY', 'skywest': 'SKYW', 'boston properties': 'BXP', 'enable midstream partners': 'ENBL', 'middleby': 'MIDD', 'now': 'DNOW', 'unisys': 'UIS', 'visteon': 'VC', 'graham holdings': 'GHC', 'resolute forest products': 'RFP', 'caleres': 'CAL', 'agnc investment': 'AGNC', 'hill-rom holdings': 'HRC', 'moog': 'MOGA', 'legg mason': '', 'atmos energy': 'ATO', 'woodward': 'WWD', 'palo alto networks': 'PANW', 'h.b. fuller': 'FUL', 'akamai technologies': 'AKAM', 'avaya holdings': 'AVYA', 'maximus': 'MMS', 'perkinelmer': 'PKI', 'hawaiian electric industries': 'HE', 'kansas city southern': 'KSU', 'aptargroup': 'ATR', 'public storage': 'PSA', 'selective insurance group': 'SIGI', 'itt': 'ITT', 'donaldson': 'DCI', 'park hotels & resorts': 'PK', 'kirby': 'KEX', 'hawaiian holdings': 'HA', 'popular': 'BPOP', 'range resources': 'RRC', 'pc connection': 'CNXN', 'amica mutual insurance': '', 'enersys': 'ENS', 'helmerich & payne': 'HP', 'nlv financial': '', 'valmont industries': 'VMI', 'pae': 'PAE', 'texas roadhouse': 'TXRH', 'cooper tire & rubber': 'CTB', 'euronet worldwide': 'EEFT', 'zillow group': 'ZG', 'atlas air worldwide holdings': 'AAWW', 'energizer holdings': 'ENR', 'magellan midstream partners': 'MMP', 'hain celestial group': 'HAIN', 'univision communications': '', 'equity residential': 'EQR', 'allison transmission holdings': 'ALSN', 'colony capital': 'CLNY', 'ttm technologies': 'TTMI', 'clear channel outdoor holdings': 'CCO', 'guess': 'GES', 'rent-a-center': 'RCII', 'take-two interactive software': 'TTWO', 'vishay intertechnology': 'VSH', 'transunion': 'TRU', 'cooper': 'COO', 'fleetcor technologies': 'FLT', 'rh': 'RH', 'renewable energy group': 'REGI', 'bluelinx holdings': 'BXC', 'california resources': 'CRC', 'topbuild': 'BLD', 'charles river laboratories international': 'CRL', 'comfort systems usa': 'FIX', 'verisk analytics': 'VRSK', 'resmed': 'RMD', 'teleflex': 'TFX', 'new jersey resources': 'NJR', 'new residential investment': 'NRZ', 'interactive brokers group': 'IBKR', 'zayo group holdings': '', 'herman miller': 'MLHR', 'grocery outlet holding': 'GO', 'j.crew group': '', 'century communities': 'CCS', 'caesars entertainment': 'CZR', 'catalent': 'CTLT', 'itron': 'ITRI', 'm/i homes': 'MHO', 'cboe global markets': 'CBOE', 'idex': 'IEX', 'belden': 'BDC', 'curtiss-wright': 'CW', 'cheesecake factory': 'CAKE', 'genesis energy': 'GEL', 'geo group': 'GEO', 'patterson-uti energy': 'PTEN', 'werner enterprises': 'WERN', 'ingersoll rand': 'IR', 'verso': 'VRS', 'mueller industries': 'MLI', 'nu skin enterprises': 'NUS', 'revlon': 'REV', 'arista networks': 'ANET', 'idexx laboratories': 'IDXX', 'align technology': 'ALGN', 'waters': 'WAT', 'synovus financial': 'SNV', 'brightview holdings': 'BV', 'rev group': 'REVG', 'brown & brown': 'BRO', 'valvoline': 'VVV', 'knights of columbus': '', 'central garden & pet': 'CENT', 'carpenter technology': 'CRS', 'slm': 'SLM', 'kennametal': 'KMT', 'lci industries': 'LCII', 'trueblue': 'TBI', 'cimarex energy': 'XEC', 'splunk': 'SPLK', 'siteone landscape supply': 'SITE', 'hexcel': 'HXL', 'fti consulting': 'FCN', 'party city holdco': 'PRTY', 'ohio national mutual': '', 'patrick industries': 'PATK', 'cadence design systems': 'CDNS', 'cdk global': 'CDK', 'avalonbay communities': 'AVB', 'wabash national': 'WNC', 'service properties trust': 'SVC', 'maxim integrated products': 'MXIM', "people's united financial": 'PBCT', 'bio-rad laboratories': 'BIO', 'option care health': 'OPCH', 'louisiana-pacific': 'LPX', 'tegna': 'TGNA', 'teradyne': 'TER', 'arch resources': 'ARCH', 'epam systems': 'EPAM', 'wpx energy': '', 'alpha metallurgical resources': 'AMR', 'ensign group': 'ENSG', 'first horizon national': 'FHN', 'wolverine world wide': 'WWW', 'vail resorts': 'MTN', 'benchmark electronics': 'BHE', 'hni': 'HNI', 'f5 networks': 'FFIV', 'affiliated managers group': 'AMG', 'oge energy': 'OGE', 'universal': 'UVV', 'bok financial': 'BOKF', 'mantech international': 'MANT', 'summit materials': 'SUM', 'amn healthcare services': 'AMN', 'groupon': 'GRPN', 'newmark group': 'NMRK', 'fossil group': 'FOSL', 'modine manufacturing': 'MOD', 'griffon': 'GFF', 'cypress semiconductor': '', 'generac holdings': 'GNRC', 'matson': 'MATX', 'genesco': 'GCO', 'nordson': 'NDSN', 'newmarket': 'NEU', 'echo global logistics': 'ECHO', 'rexnord': 'RXN', 'incyte': 'INCY', 'fortinet': 'FTNT', 'foundation building materials': 'FBM', 'aar': 'AIR', 'centric brands': 'CTRC', 'edgewell personal care': 'EPC', 'federated mutual insurance': '', 'schnitzer steel industries': 'SCHN', 'portland general electric': 'POR', 'gray television': 'GTN', 'bgc partners': 'BGCP', 'echostar': 'SATS', 'beazer homes usa': 'BZH', 'lhc group': 'LHCG', 'servicemaster global holdings': 'SERV', 'bruker': 'BRKR', 'oasis petroleum': 'OAS', 'crossamerica partners': 'CAPL', 'myr group': 'MYRG', 'viasat': 'VSAT', 'gnc holdings': 'GNC', 'cabot oil & gas': 'COG', 'bright horizons family solutions': 'BFAM', 'vista outdoor': 'VSTO', 'heico': 'HEI', 'wyndham hotels & resorts': 'WH', 'tcf financial': 'TCF', 'primerica': 'PRI', 'propetro holding': 'PUMP', 'oceaneering international': 'OII', 'floor & decor holdings': 'FND', 'copart': 'CPRT', "chico's fas": 'CHS', 'barnes & noble education': 'BNED', 'maxar technologies': 'MAXR', 'evercore': 'EVR', 'deckers outdoor': 'DECK', 'express': 'EXPR', 'hovnanian enterprises': 'HOV', 'air lease': 'AL', 'rollins': 'ROL', 'sba communications': 'SBAC', 'deluxe': 'DLX', 'mr. cooper group': 'COOP', 'herc holdings': 'HRI', 'healthpeak properties': 'PEAK', 'spx flow': 'FLOW', 'liberty oilfield services': 'LBRT'}


def speak(text):
    tts = gTTS(text=text, lang="en")
    filename = "voice.mp3"
    tts.save(filename)
    playsound.playsound(filename)


def get_audio():
    r = sr.Recognizer()
    with sr.Microphone() as source:
        speak("i am listening")
        print("i am listening")
        audio = r.listen(source)
        said = ""
        try:
            said = r.recognize_google(audio)
            print(said)
        except Exception as e:
            print("Exception: " + str(e))
            speak("sorry sir, i couldn't hear you properly.")
    return said


def get_stocks(t):
    text_l = t.lower()
    for word in text_l.split():
        if word in stocks.keys():
            ticker = yf.Ticker(stocks[word])
            for action in text_l.split():
                if action == "dividends":
                    df = ticker.dividends
                    print(df)
                    data = df.resample('Y').sum()
                    data = data.reset_index()
                    data['Year'] = data['Date'].dt.year
                    plt.figure()
                    plt.bar(data['Year'], data['Dividends'])
                    plt.xlabel('Year')
                    plt.ylabel('Dividend Yield ($)')
                    plt.title(
                        '{} historic dividend yield'.format(word))
                    plt.xlim(2000, datetime.now().year)
                    plt.show()
                elif action == "cash":
                    print(ticker.cashflow)
                elif action == "major":
                    print(ticker.major_holders)
                elif action == "institutional":
                    print(ticker.institutional_holders)

                else:
                    pass

        else:
            pass


def get_note(note):
    speak("how would you like to name your note, sir?")
    file_name = get_audio()+".txt"
    with open(file_name, "w") as f:
        f.write(note)
    subprocess.run(['open', file_name], capture_output=True, text=True)
    speak("Note saved as " + file_name)


text = get_audio()
NOTE_WORDS = ["note", "make a note",
              "make a note of this", "write this down", "write down"]
for word in NOTE_WORDS:
    if word in text:
        speak("what would you like to note, sir?")
        note = get_audio()
        get_note(note)
        speak("Done, sir.")
        break


def get_ticker_data(ticker):
    speak("please wait while i fetch the weather for " + ticker)
    weather_data = yf.download(tickers=ticker, interval='1mo')
    weather_data.to_csv(ticker+'.csv')
    speak("weather data for " + ticker +
          " has been saved as " + ticker + ".csv")
    subprocess.run(['open', ticker+'.csv'], capture_output=True, text=True)
    speak("weather data for " + ticker + " has been opened in excel")
    speak("thank you sir")


# speak("of course sir. On my way ")
# get_stocks(text)
